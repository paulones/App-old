<ui:composition template="../template/template.xhtml" 
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://xmlns.jcp.org/jsf/passthrough">
    <ui:define name="title">Pessoa Jurídica - Sucessão Empresarial</ui:define>
    <ui:define name="metadata-components">
        <f:event type="preRenderComponent" listener="#{sucessaoBean.init()}"/>
    </ui:define>
    <ui:define name="page-styles">
        <!-- BEGIN PAGE LEVEL PLUGIN STYLES -->
        <link rel="stylesheet" type="text/css" href="../assets/global/plugins/datatables/plugins/bootstrap/dataTables.bootstrap.css"/>
        <!-- END PAGE LEVEL PLUGIN STYLES -->
        <!-- BEGIN PAGE STYLES -->
        <style>
            #modal .control-label{margin-top:7px !important}
        </style>
        <!-- END PAGE STYLES -->
    </ui:define>
    <ui:define name="content">
        <!-- BEGIN PAGE HEADER-->
        <div class="row">
            <div class="col-md-12">
                <!-- BEGIN PAGE TITLE e BREADCRUMB-->
                <h3 class="page-title">
                    Pessoa Jurídica <small>Sucessão</small>
                </h3>
                <ul class="page-breadcrumb breadcrumb">
                    <li>
                        <i class="fa fa-home"></i>
                        <a href="../home.xhtml">Home</a>
                        <i class="fa fa-angle-right"/>
                    </li>
                    <li>
                        <i class="fa fa-institution"></i>
                        <a href="#">Pessoa Jurídica</a>
                        <i class="fa fa-angle-right"></i>
                    </li>
                    <li>
                        <i class="fa fa-exchange"></i>
                        <a href="#">Sucessão</a>
                    </li>
                </ul>
                <!-- END PAGE TITLE e BREADCRUMB-->
            </div>
        </div>
        <!-- END PAGE HEADER-->
        <!-- BEGIN PAGE CONTENT-->

        <div class="row">
            <div class="col-md-12">
                <div class="portlet box blue-chambray">
                    <div class="portlet-title">
                        <div class="caption">
                            <i class="fa fa-exchange"></i>
                            Sucessão de Empresas
                        </div>
                    </div>
                    <div class="portlet-body">
                        <!-- BEGIN FORM-->
                        <h:form prependId="false" id="form" class="form-horizontal">
                            <h:panelGroup layout="block" class="alert alert-info" rendered="#{sucessaoBean.succeed eq 'fail'}">
                                <button class="close" data-close="alert"></button>
                                <h:messages layout="table" class="pf-error"/> 
                            </h:panelGroup>
                            <h:panelGroup layout="block" class="alert alert-success" rendered="#{sucessaoBean.succeed eq 'success'}">
                                <button class="close" data-close="alert"></button>
                                Sucessão realizada com sucesso!
                            </h:panelGroup>
                            <span class="help-block">Se faz necessário que tanto a empresa sucedida e a sucessora estejam cadastradas no sistema.</span>
                            <h3 class="form-section">Empresa Sucedida</h3>
                            <!--/row-->
                            <div class="row">
                                <div class="col-md-9">
                                    <div class="form-group">
                                        <label class="control-label col-md-2">CNPJ</label>
                                        <div class="col-md-9">
                                            <h:selectOneMenu styleClass="select2_category select2me form-control" p:placeholder="Selecione..." id="sucedida" value="#{sucessaoBean.sucedida}" tabindex="1" converter="entityConverter">
                                                <f:selectItem itemLabel="" itemValue=""/>
                                                <ui:param value="#{pessoaJuridica.cnpj.substring(0,2)}.#{pessoaJuridica.cnpj.substring(2,5)}.#{pessoaJuridica.cnpj.substring(5,8)}/#{pessoaJuridica.cnpj.substring(8,12)}-#{pessoaJuridica.cnpj.substring(12)}" name="cnpj"/>
                                                <f:selectItems value="#{sucessaoBean.pessoaJuridicaList}" var="pessoaJuridica" itemLabel="#{cnpj} - #{pessoaJuridica.nome}" itemValue="#{pessoaJuridica}"/>
                                            </h:selectOneMenu>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-2">
                                    <button  class="btn blue-chambray" id="vinculate">
                                        <i class="fa fa-plus-circle"></i> Cadastrar Nova Empresa</button>
                                    <h:commandLink styleClass="vinculate">
                                        <f:ajax event="click" listener="#{sucessaoBean.cadastrarSucedida}"/>
                                    </h:commandLink>
                                </div>
                            </div>
                            <!--/row-->
                            <h3 class="form-section">Empresa Sucessora</h3>
                            <!--/row-->
                            <div class="row">
                                <div class="col-md-9">
                                    <div class="form-group">
                                        <label class="control-label col-md-2">CNPJ</label>
                                        <div class="col-md-9">
                                            <h:selectOneMenu styleClass="select2_category select2me form-control" p:placeholder="Selecione..." id="sucessora" value="#{sucessaoBean.sucessora}" tabindex="1" converter="entityConverter">
                                                <f:selectItem itemLabel="" itemValue=""/>
                                                <ui:param value="#{pessoaJuridica.cnpj.substring(0,2)}.#{pessoaJuridica.cnpj.substring(2,5)}.#{pessoaJuridica.cnpj.substring(5,8)}/#{pessoaJuridica.cnpj.substring(8,12)}-#{pessoaJuridica.cnpj.substring(12)}" name="cnpj"/>
                                                <f:selectItems value="#{sucessaoBean.pessoaJuridicaList}" var="pessoaJuridica" itemLabel="#{cnpj} - #{pessoaJuridica.nome}" itemValue="#{pessoaJuridica}"/>
                                            </h:selectOneMenu>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-2">
                                    <button  class="btn blue-chambray" id="vinculate">
                                        <i class="fa fa-plus-circle"></i> Cadastrar Nova Empresa</button>
                                    <h:commandLink styleClass="vinculate">
                                        <f:ajax event="click" listener="#{sucessaoBean.cadastrarSucessora}"/>
                                    </h:commandLink>
                                </div>
                            </div>
                            <br/>
                            <div class="form-actions right">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="col-md-offset-3 col-md-9">
                                            <button type="submit" class="btn blue-chambray">
                                                <ui:fragment><i class="fa fa-exchange"></i> Suceder</ui:fragment>
                                            </button>
                                        </div>
                                        <h:commandLink styleClass="register" action="#{sucessaoBean.suceder}"/>
                                    </div>
                                </div>
                            </div>
                        </h:form>
                        <!-- END FORM-->
                    </div>
                </div>
            </div>
        </div>
        <!-- END PAGE CONTENT-->
    </ui:define>
    <ui:define name="page-scripts">
        <!-- BEGIN PAGE LEVEL PLUGINS -->
        <!-- IMPORTANT! fullcalendar depends on jquery-ui-1.10.3.custom.min.js for drag e drop support -->
        <!-- END PAGE LEVEL PLUGINS -->
        <!-- BEGIN PAGE LEVEL SCRIPTS -->
        <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.mask/0.9.0/jquery.mask.min.js" type="text/javascript"></script>
        <script type="text/javascript" src="../assets/global/plugins/jquery-validation/js/jquery.validate.js"></script>
        <script type="text/javascript" src="../assets/global/plugins/jquery-validation/js/localization/messages_pt_BR.js"></script>
        <script src="../assets/admin/pages/scripts/pj-sucessao.js" type="text/javascript"></script>
        <!-- END PAGE LEVEL SCRIPTS -->
        <script>
            jQuery(document).ready(function() {
                Metronic.init(); // init metronic core componets
                Layout.init(); // init layout
                PJSuc.init();
            });
        </script>
    </ui:define>
</ui:composition>