<ui:composition template="../template/template.xhtml" 
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets">
    <ui:define name="title">Pessoa Jurídica - Consulta</ui:define>
    <ui:define name="metadata-components">
        <f:event type="preRenderComponent" listener="#{pessoaJuridicaBean.init()}"/>
    </ui:define>
    <ui:define name="page-styles">
        <!-- BEGIN PAGE LEVEL PLUGIN STYLES -->
        <link rel="stylesheet" type="text/css" href="../assets/global/plugins/datatables/plugins/bootstrap/dataTables.bootstrap.css"/>
        <!-- END PAGE LEVEL PLUGIN STYLES -->
        <!-- BEGIN PAGE STYLES -->
        <!-- END PAGE STYLES -->
    </ui:define>
    <ui:define name="content">
        <!-- BEGIN PAGE HEADER-->
        <div class="row">
            <div class="col-md-12">
                <!-- BEGIN PAGE TITLE e BREADCRUMB-->
                <h3 class="page-title">
                    Pessoa Jurídica <small>Consulta #{!pessoaJuridicaBean.history ? '':'de histórico'}</small>
                </h3>
                <ul class="page-breadcrumb breadcrumb">
                    <li>
                        <i class="fa fa-home"></i>
                        <a href="../home.xhtml">Home</a>
                        <i class="fa fa-angle-right"/>
                    </li>
                    <li>
                        <i class="fa fa-building"></i>
                        <a href="#">Pessoa Jurídica</a>
                        <i class="fa fa-angle-right"></i>
                    </li>
                    <h:panelGroup rendered="#{pessoaFisicaBean.history}">
                        <li>
                            <a href="../pessoa-juridica/consultar.xhtml">Consultar</a>
                            <i class="fa fa-angle-right"></i>
                        </li>
                    </h:panelGroup>
                    <li>
                        <a href="../pessoa-juridica/consultar.xhtml#{pessoaJuridicaBean.history ? '?id=' :''}#{pessoaJuridicaBean.history ? pessoaJuridicaBean.pessoaJuridica.id : ''}">Consultar #{!pessoaJuridicaBean.history ? '':'histórico'}</a>
                    </li>
                </ul>
                <!-- END PAGE TITLE e BREADCRUMB-->
            </div>
        </div>
        <!-- END PAGE HEADER-->
        <!-- BEGIN PAGE CONTENT-->
        <h:form  id="form">
            <div class="row">
                <div class="col-md-12">
                    <!-- BEGIN EXAMPLE TABLE PORTLET-->
                    <div class="portlet box blue-chambray">
                        <div class="portlet-title">
                            <div class="caption">
                                <i class="fa fa-globe"></i>
                                #{!pessoaJuridicaBean.history ? 'Registro de Pessoas Jurídicas':'Histórico de '}#{!pessoaJuridicaBean.history ? '' : pessoaJuridicaBean.pessoaJuridica.nome}
                            </div>
                        </div>
                        <div class="portlet-body">
                            <h:panelGroup layout="block" class="alert alert-info"  rendered="#{pessoaJuridicaBean.redirect eq 'fail'}">
                                <button class="close" data-close="alert"></button>
                                Nenhum campo foi alterado.
                            </h:panelGroup>
                            <h:panelGroup layout="block" class="alert alert-success"  rendered="#{pessoaJuridicaBean.redirect eq 'success'}">
                                <button class="close" data-close="alert"></button>
                                Cadastro alterado com sucesso!
                            </h:panelGroup>
                            <h:panelGroup layout="block" class="alert alert-success"  rendered="#{pessoaJuridicaBean.register eq 'success'}">
                                <button class="close" data-close="alert"></button>
                                Cadastro removido com sucesso!
                            </h:panelGroup>
                            <ui:fragment rendered="#{!pessoaJuridicaBean.history}">
                                <span class="help-block">Para alterar os dados de uma Pessoa Jurídica, clique no <span class="expand-example"></span> e, em seguida, clique no botão de alterar.</span>
                            </ui:fragment>
                            <ui:fragment rendered="#{pessoaJuridicaBean.history}">
                                <span class="help-block">Para visualizar os dados alterados de um registro anterior em relação ao atual,clique no <span class="expand-example"></span>.</span>
                                <span class="help-block">Os campos alterados estão destacados na cor vermelha.</span>
                            </ui:fragment>
                            <br/>
                            <table class="table table-striped table-bordered table-hover" id="table">
                                <thead>
                                    <tr>  
                                        <h:panelGroup rendered="#{!pessoaJuridicaBean.history}">
                                            <th style="width:3%"></th>
                                            <th>
                                                Nome
                                            </th>
                                            <th>
                                                CNPJ
                                            </th>
                                            <th>
                                                Nome Fantasia
                                            </th>
                                            <th>
                                                Tipo Empresarial
                                            </th>
                                            <th style="width:3%"></th>
                                            <th class="display-hide"></th>
                                        </h:panelGroup>
                                        <h:panelGroup rendered="#{pessoaJuridicaBean.history}">
                                            <th style="width:3%"></th>
                                            <th style="width:15%">
                                                Registro
                                            </th>
                                            <th style="width:44%">
                                                Descrição da alteração
                                            </th>
                                            <th style="width:40%">
                                                Usuário alterador
                                            </th>
                                            <th class="display-hide"></th>
                                        </h:panelGroup>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- BEGIN LISTA DE HISTÓRICOS -->
                                    <ui:repeat value="#{pessoaJuridicaBean.enderecoPessoaFisicaJuridicaHistoricoList}" var="historico" rendered="#{pessoaJuridicaBean.history}">
                                    </ui:repeat>
                                    <!-- END LISTA DE HISTÓRICOS -->
                                    <!-- BEGIN LISTA GERAL -->
                                    <ui:repeat value="#{pessoaJuridicaBean.enderecoPessoaList}" var="pessoaJuridica" varStatus="status" rendered="#{!pessoaJuridicaBean.history}">
                                        <tr>
                                            <td class="expand-box">
                                                <span class="row-details row-details-close"></span>
                                            </td>
                                             <td>
                                                #{pessoaJuridica.pessoa.nome}
                                            </td>
                                            <td>
                                                <ui:param value="#{pessoaJuridica.pessoa.cnpj.substring(0,2)}.#{pessoaJuridica.pessoa.cnpj.substring(2,5)}.#{pessoaJuridica.pessoa.cnpj.substring(5,8)}/#{pessoaJuridica.pessoa.cnpj.substring(8,12)}-#{pessoaJuridica.pessoa.cnpj.substring(12)}" name="cnpj"/>
                                                #{pessoaJuridica.pessoa.cnpj eq null ? '-' : cnpj}
                                            </td>
                                            <td>
                                                #{pessoaJuridica.pessoa.nomeFantasia}
                                            </td>
                                            <td>
                                                #{pessoaFisica.pessoa.tipoEmpresarialFk.tipo}
                                            </td>
                                            <td>
                                                <a href="javascript:;" class="button-delete" >
                                                    <i class="glyphicon glyphicon-remove" style="color:red"/> </a>
                                                <h:commandLink class="delete" action="#{pessoaJuridicaBean.removerPessoaJuridica(status.index)}" />
                                            </td>
                                            <td></td>
                                        </tr>
                                    </ui:repeat>
                                    <!-- END LISTA GERAL -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <!-- END EXAMPLE TABLE PORTLET-->
                </div>
            </div>
        </h:form>
        <!-- END PAGE CONTENT-->
        <a class="btn default display-hide delete-modal-activator" data-toggle="modal" href="#static"></a>
        <div id="static" class="modal fade" tabindex="-1" data-backdrop="static" data-keyboard="false">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title"><i class="fa fa-exclamation-triangle"></i> Remover Pessoa Jurídica <i class="fa fa-exclamation-triangle"></i></h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            Tem certeza que deseja remover esta Pessoa Jurídica?
                        </p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" data-dismiss="modal" class="btn default cancel">Cancelar</button>
                        <button type="button" data-dismiss="modal" class="btn blue-chambray remove">Remover</button>
                    </div>
                </div>
            </div>
        </div>
    </ui:define>
    <ui:define name="page-scripts">
        <!-- BEGIN PAGE LEVEL PLUGINS -->
        <!-- IMPORTANT! fullcalendar depends on jquery-ui-1.10.3.custom.min.js for drag e drop support -->
        <script type="text/javascript" src="../assets/global/plugins/datatables/media/js/jquery.dataTables.min.js"></script>
        <script type="text/javascript" src="../assets/global/plugins/datatables/plugins/bootstrap/dataTables.bootstrap.js"></script>
        <!-- END PAGE LEVEL PLUGINS -->
        <!-- BEGIN PAGE LEVEL SCRIPTS -->
        <script src="../assets/admin/pages/scripts/pj-consultar.js" type="text/javascript"></script>
        <!-- END PAGE LEVEL SCRIPTS -->
        <script>
            jQuery(document).ready(function() {
                Metronic.init(); // init metronic core componets
                Layout.init(); // init layout
                PJCon.init();
            });
        </script>
    </ui:define>
</ui:composition>